name: Go Build and Deploy

on: [push, pull_request]

jobs:
  build-and-run:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Go
        uses: actions/setup-go@v4
        with:
          go-version: '1.20' # ajusta a la versi√≥n que uses

      - name: Show go version
        run: go version

      - name: Build binary
        run: |
          echo "Compilando..."
          go env
          go build -v -o main ./...
          ls -la

      - name: Run binary
        run: |
          echo "Comprobando existencia del binario"
          if [ ! -f ./main ]; then
            echo "Error: ./main no existe"
            exit 1
          fi
          echo "Ejecutando ./main"
          ./main
